{"version":3,"file":"esm.js","sources":["src/logger.js","src/object.js","src/population.js","src/stat.js","src/flag.js","src/environment.js","src/lru.js","src/router.js","src/airship.js","src/validators/core_validator.js","src/transformers/core_transformer.js","src/core.js","src/index.js"],"sourcesContent":["export let logger = x => {\n  // eslint-disable-next-line no-console\n  console.error(x)\n}\n\nexport function setLogger(fn) {\n  logger = fn\n}\n","import Ajv from 'ajv'\nimport ajvErrors from 'ajv-errors'\nimport md5 from 'md5'\nimport {logger} from './logger'\nimport stringify from 'fast-json-stable-stringify'\n\nconst SCHEMA = {\n  type: 'object',\n  properties: {\n    type: {\n      type: 'string',\n      pattern: '^([A-Z][a-zA-Z]*)+$',\n      maxLength: 50,\n      minLength: 1,\n      errorMessage: {\n        type:\n          'Entity type must be a string that starts with a capital letter like [C]ar or [U]ser',\n        maxLength:\n          'Entity type must be a non-empty string of 50 characters or less',\n        minLength:\n          'Entity type must be a non-empty string of 50 characters or less'\n      }\n    },\n    isGroup: {\n      type: 'boolean',\n      errorMessage: {\n        type: '`isGroup` must be a boolean'\n      }\n    },\n    id: {\n      type: ['string', 'integer'],\n      pattern: '^[ -~]+$',\n      maxLength: 250,\n      minLength: 1,\n      errorMessage: {\n        type:\n          \"An entity's `id` must be a string or integer. An integer `id` will be cast into a string.\",\n        maxLength:\n          \"An entity's `id` must be a non-empty string of 250 characters or less.\",\n        minLength:\n          \"An entity's `id` must be a non-empty string of 250 characters or less.\"\n      }\n    },\n    displayName: {\n      type: 'string',\n      maxLength: 250,\n      minLength: 1,\n      errorMessage: {\n        type: \"An entity's `displayName` must be a string\",\n        maxLength:\n          \"An entity's `displayName` must be a non-empty string of 250 characters or less.\",\n        minLength:\n          \"An entity's `displayName` must be a non-empty string of 250 characters or less.\"\n      }\n    },\n    attributes: {\n      type: 'object',\n      patternProperties: {\n        '^[a-zA-Z]$|^[a-zA-Z_]{0,48}[a-zA-Z]$': {\n          oneOf: [\n            {\n              type: 'string',\n              maxLength: 3000,\n              errorMessage: {\n                type:\n                  \"An entity's attribute value must be a string, boolean, or number.\",\n                maxLength:\n                  \"An entity's string attribute must be 3000 characters or less.\"\n              }\n            },\n            {\n              type: 'boolean',\n              errorMessage: {\n                type:\n                  \"An entity's attribute value must be a string, boolean, or number.\"\n              }\n            },\n            {\n              type: 'number',\n              errorMessage: {\n                type:\n                  \"An entity's attribute value must be a string, boolean, or number.\"\n              }\n            }\n          ],\n          errorMessage: {\n            oneOf:\n              \"An entity's attribute value must be a string, boolean, or number.\"\n          }\n        }\n      },\n      maxProperties: 100,\n      additionalProperties: false,\n      errorMessage: {\n        maxProperties: 'There can only be up to 100 attributes for an entity.',\n        additionalProperties:\n          'Each attribute must begin and end with an alphabet letter (a-z, A-Z). In between, allowed characters are a-z, A-Z, and \"_\". For example: isStudent or is_student. Preceding or trailing underscore is not allowed (i.e., _is_student or is_student_). Each attribute value must be a number, string or boolean.'\n      }\n    },\n    group: {\n      type: ['object', 'null'],\n      properties: {\n        type: {\n          type: 'string',\n          pattern: '^([A-Z][a-zA-Z]*)+$',\n          maxLength: 50,\n          minLength: 1,\n          errorMessage: {\n            type:\n              'Group type must be a string that starts with a capital letter like [C]arGroup or [U]serGroup. Camel casing is used to separate words.',\n            maxLength:\n              'Group type must be a non-empty string of 50 characters or less',\n            minLength:\n              'Group type must be a non-empty string of 50 characters or less'\n          }\n        },\n        isGroup: {\n          type: 'boolean',\n          enum: [true],\n          errorMessage: {\n            type: '`isGroup` must be a boolean',\n            enum: '`isGroup` must always be true for an group'\n          }\n        },\n        id: {\n          type: ['string', 'integer'],\n          pattern: '^[ -~]+$',\n          maxLength: 250,\n          minLength: 1,\n          errorMessage: {\n            type:\n              \"A group's `id` must be a string or integer. An integer `id` will be cast into a string.\",\n            maxLength:\n              \"A group's `id` must be a non-empty string of 250 characters or less.\",\n            minLength:\n              \"A group's `id` must be a non-empty string of 250 characters or less.\"\n          }\n        },\n        displayName: {\n          type: 'string',\n          maxLength: 250,\n          minLength: 1,\n          errorMessage: {\n            type: \"A group's `displayName` must be a string\",\n            maxLength:\n              \"A group's `displayName` must be a non-empty string of 250 characters or less.\",\n            minLength:\n              \"A group's `displayName` must be a non-empty string of 250 characters or less.\"\n          }\n        },\n        attributes: {\n          type: 'object',\n          patternProperties: {\n            '^[a-zA-Z]$|^[a-zA-Z_]{0,48}[a-zA-Z]$': {\n              oneOf: [\n                {\n                  type: 'string',\n                  maxLength: 3000,\n                  errorMessage: {\n                    type:\n                      \"A group's attribute value must be a string, boolean, or number.\",\n                    maxLength:\n                      \"A group's string attribute must be 3000 characters or less.\"\n                  }\n                },\n                {\n                  type: 'boolean',\n                  errorMessage: {\n                    type:\n                      \"A group's attribute value must be a string, boolean, or number.\"\n                  }\n                },\n                {\n                  type: 'number',\n                  errorMessage: {\n                    type:\n                      \"A group's attribute value must be a string, boolean, or number.\"\n                  }\n                }\n              ],\n              errorMessage: {\n                oneOf:\n                  \"A group's attribute value must be a string, boolean, or number.\"\n              }\n            }\n          },\n          maxProperties: 100,\n          additionalProperties: false,\n          errorMessage: {\n            additionalProperties:\n              'Each attribute must begin and end with an alphabet letter (a-z, A-Z). In between, allowed characters are a-z, A-Z, and \"_\". For example: isStudent or is_student. Preceding or trailing underscore is not allowed (i.e., _is_student or is_student_). Each attribute value must be a number, string or boolean.'\n          }\n        }\n      },\n      required: ['id'],\n      additionalProperties: false,\n      errorMessage: {\n        required: 'Each group must have an `id` field.',\n        additionalProperties:\n          'Allowed properties for a group are: `type`, `id`, `displayName`, `attributes`, and `isGroup`. `id` is required, rest are optional.'\n      }\n    }\n  },\n  required: ['id'],\n  additionalProperties: false,\n  errorMessage: {\n    type: 'An entity is represented using a dictionary',\n    required: 'Each entity must have an `id` field.',\n    additionalProperties:\n      'Allowed properties for an entity are: `type`, `id`, `displayName`, `attributes`, `group`, and `isGroup`. `id` is required, rest are optional.'\n  }\n}\n\nconst ajv = Ajv({allErrors: true, jsonPointers: true})\najvErrors(ajv)\nconst validate = ajv.compile(SCHEMA)\n\nexport const DEFAULT_ENTITY_TYPE = 'User'\n\nexport default class AirshipObject {\n  constructor(obj) {\n    let isValid = AirshipObject.isValidObject(obj)\n\n    if (!isValid) {\n      this.object = null\n      return\n    }\n\n    obj = AirshipObject._cloneObject(obj)\n    isValid = AirshipObject._fillInFields(obj)\n\n    if (!isValid) {\n      this.object = null\n      return\n    }\n\n    this.object = obj\n  }\n\n  static isValidObject(obj) {\n    let isValid = validate(obj)\n    if (!isValid) {\n      logger(validate.errors.map(e => e.message))\n    }\n\n    if (isValid) {\n      const isGroup = obj.isGroup !== undefined ? obj.isGroup : false\n      const type = obj.type !== undefined ? obj.type : DEFAULT_ENTITY_TYPE\n\n      const groupIndex = type.lastIndexOf('Group')\n      if (\n        groupIndex !== -1 &&\n        groupIndex === type.length - 'Group'.length &&\n        !isGroup\n      ) {\n        logger(\n          \"An entity's type that ends with `Group` must be a group entity and therefore has to have an explicit `isGroup: true` property\"\n        )\n        isValid = false\n      }\n    }\n\n    return isValid\n  }\n\n  static _cloneObject(obj) {\n    const clone = Object.assign({}, obj)\n\n    if (obj.attributes !== undefined) {\n      clone.attributes = Object.assign({}, obj.attributes)\n    }\n\n    if (obj.group !== undefined) {\n      clone.group = Object.assign({}, obj.group)\n\n      if (obj.group.attributes !== undefined) {\n        clone.group.attributes = Object.assign({}, obj.group.attributes)\n      }\n    }\n\n    return clone\n  }\n\n  static _fillInFields(obj) {\n    if (obj.type === undefined) {\n      obj.type = DEFAULT_ENTITY_TYPE\n    }\n\n    if (obj.displayName === undefined) {\n      obj.displayName = '' + obj.id\n    }\n\n    if (obj.isGroup === undefined) {\n      obj.isGroup = false\n    }\n\n    if (Number.isInteger(obj.id)) {\n      const idStr = '' + obj.id\n      if (idStr.length > 250) {\n        logger('Integer id must have 250 digits or less')\n        return false\n      }\n      obj.id = idStr\n    }\n\n    let group = null\n    if (obj.group !== undefined) {\n      group = obj.group\n    }\n\n    if (group !== null && group.displayName === undefined) {\n      group.displayName = '' + group.id\n    }\n\n    if (group !== null && group.type === undefined) {\n      group.type = obj.type + 'Group'\n    }\n\n    if (group !== null) {\n      group.isGroup = true\n    }\n\n    if (group !== null) {\n      if (Number.isInteger(group.id)) {\n        const idStr = '' + group.id\n        if (idStr.length > 250) {\n          logger('Integer id must have 250 digits or less')\n          return false\n        }\n        group.id = idStr\n      }\n    }\n\n    return true\n  }\n\n  getHash() {\n    return md5(\n      stringify({\n        ...this.object,\n        attributes: this.object.attributes || {},\n        group: {\n          ...this.object.group,\n          attributes: (this.object.group && this.object.group.attributes) || {}\n        }\n      })\n    )\n  }\n\n  getId() {\n    const obj = this.object\n    return `${obj.type}_${obj.id}`\n  }\n\n  isValid() {\n    return this.object !== null\n  }\n\n  getRawObject() {\n    return this.object\n  }\n\n  getObject() {\n    const obj = this.object\n    const clone = Object.assign({}, obj)\n    delete clone.group\n    return new AirshipObject(clone)\n  }\n\n  getGroup() {\n    const group = this.object.group || null\n    return group && new AirshipObject(group)\n  }\n}\n","import md5 from 'md5'\nimport {logger} from './logger'\n\nexport const RULE_TYPE_STRING = 'string'\nexport const RULE_TYPE_INT = 'int'\nexport const RULE_TYPE_FLOAT = 'float'\nexport const RULE_TYPE_BOOLEAN = 'boolean'\nexport const RULE_TYPE_DATE = 'date'\nexport const RULE_TYPE_DATETIME = 'datetime'\n\nexport const RULE_OPERATOR_IS = 'is'\nexport const RULE_OPERATOR_IS_NOT = 'is_not'\nexport const RULE_OPERATOR_IN = 'in'\nexport const RULE_OPERATOR_NOT_IN = 'not_in'\nexport const RULE_OPERATOR_LT = 'lt'\nexport const RULE_OPERATOR_LTE = 'lte'\nexport const RULE_OPERATOR_GT = 'gt'\nexport const RULE_OPERATOR_GTE = 'gte'\nexport const RULE_OPERATOR_FROM = 'from'\nexport const RULE_OPERATOR_UNTIL = 'until'\nexport const RULE_OPERATOR_AFTER = 'after'\nexport const RULE_OPERATOR_BEFORE = 'before'\n\nexport const getHashedValue = s => {\n  return (parseInt(md5(s), 16) * 1.0) / 340282366920938463463374607431768211455\n}\n\nexport default class Population {\n  constructor(population) {\n    this.population = population\n  }\n\n  static categorizeValueType(v) {\n    if (v === true || v === false) {\n      return 'boolean'\n    } else if (typeof v === 'number') {\n      if ((v + '').indexOf('.') >= 0) {\n        return 'float'\n      } else {\n        return 'int'\n      }\n    } else if (typeof v === 'string') {\n      const unixTimestamp = new Date(v).getTime()\n\n      if (!isNaN(unixTimestamp)) {\n        const isoFormat = new Date(v).toISOString()\n        const timeIndex = isoFormat.lastIndexOf('T00:00:00.000Z')\n        if (\n          timeIndex !== -1 &&\n          isoFormat.length - 'T00:00:00.000Z'.length === timeIndex\n        ) {\n          return 'date'\n        } else {\n          return 'datetime'\n        }\n      }\n\n      return 'string'\n    }\n    logger('Unexpected attribute value type encountered')\n    return null\n  }\n\n  _ruleMatches(rule, obj) {\n    const attributes = obj.attributes || {}\n\n    if (!attributes.hasOwnProperty(rule.attributeName)) {\n      return false\n    }\n\n    const v = attributes[rule.attributeName]\n    const attributeType = Population.categorizeValueType(v)\n\n    const numberTypes = [RULE_TYPE_INT, RULE_TYPE_FLOAT]\n\n    if (\n      numberTypes.indexOf(attributeType) !== -1 &&\n      numberTypes.indexOf(rule.attributeType) !== -1\n    ) {\n      // This is fine\n    } else if (attributeType !== rule.attributeType) {\n      return false\n    }\n\n    const targetVal = rule.value\n    const targetValList = rule.valueList\n    const op = rule.operator\n\n    if (attributeType === RULE_TYPE_STRING) {\n      if (op === RULE_OPERATOR_IS) {\n        return v === targetVal\n      } else if (op === RULE_OPERATOR_IS_NOT) {\n        return v !== targetVal\n      } else if (op === RULE_OPERATOR_IN) {\n        return targetValList.indexOf(v) !== -1\n      } else if (op === RULE_OPERATOR_NOT_IN) {\n        return targetValList.indexOf(v) === -1\n      } else {\n        logger('Invalid rule operator encountered')\n        return false\n      }\n    } else if (numberTypes.indexOf(attributeType) !== -1) {\n      if (op === RULE_OPERATOR_IS) {\n        return v === targetVal\n      } else if (op === RULE_OPERATOR_IS_NOT) {\n        return v !== targetVal\n      } else if (op === RULE_OPERATOR_IN) {\n        return targetValList.indexOf(v) !== -1\n      } else if (op === RULE_OPERATOR_NOT_IN) {\n        return targetValList.indexOf(v) === -1\n      } else if (op === RULE_OPERATOR_LT) {\n        return v < targetVal\n      } else if (op === RULE_OPERATOR_LTE) {\n        return v <= targetVal\n      } else if (op === RULE_OPERATOR_GT) {\n        return v > targetVal\n      } else if (op === RULE_OPERATOR_GTE) {\n        return v >= targetVal\n      } else {\n        logger('Invalid rule operator encountered')\n        return false\n      }\n    } else if (attributeType === RULE_TYPE_BOOLEAN) {\n      if (op === RULE_OPERATOR_IS) {\n        return v === targetVal\n      } else if (op === RULE_OPERATOR_IS_NOT) {\n        return v !== targetVal\n      } else {\n        logger('Invalid rule operator encountered')\n        return false\n      }\n    } else if (\n      attributeType === RULE_TYPE_DATE ||\n      attributeType === RULE_TYPE_DATETIME\n    ) {\n      const targetTime = targetVal && new Date(targetVal).getTime()\n      const targetTimeList =\n        targetValList && targetValList.map(tv => new Date(tv).getTime())\n      const vTime = new Date(v).getTime()\n\n      if (op === RULE_OPERATOR_IS) {\n        return vTime === targetTime\n      } else if (op === RULE_OPERATOR_IS_NOT) {\n        return vTime !== targetTime\n      } else if (op === RULE_OPERATOR_IN) {\n        return targetTimeList.indexOf(vTime) !== -1\n      } else if (op === RULE_OPERATOR_NOT_IN) {\n        return targetTimeList.indexOf(vTime) === -1\n      } else if (op === RULE_OPERATOR_FROM) {\n        return vTime >= targetTime\n      } else if (op === RULE_OPERATOR_UNTIL) {\n        return vTime <= targetTime\n      } else if (op === RULE_OPERATOR_AFTER) {\n        return vTime > targetTime\n      } else if (op === RULE_OPERATOR_BEFORE) {\n        return vTime < targetTime\n      } else {\n        logger('Invalid rule operator encountered')\n        return false\n      }\n    } else {\n      logger('Invalid attribute type encountered')\n      return false\n    }\n  }\n\n  getGateValues(obj, env, flag, sticky) {\n    const population = this.population\n    if (this.population.entityType !== obj.type) {\n      return {eligible: false}\n    }\n\n    const splits = sticky\n      ? this.population.universes[\n          Math.floor(parseInt(this.population.percentage * 100)) - 1\n        ]\n      : flag.splits\n    const splitsMap = {}\n    for (let i = 0; i < splits.length; i++) {\n      const split = splits[i]\n      splitsMap[split.treatmentId] = split\n    }\n\n    const rules = population.rules\n\n    let matches = true\n\n    for (let i = 0; i < rules.length; i++) {\n      const r = rules[i]\n      matches = matches && this._ruleMatches(r, obj)\n    }\n\n    if (matches) {\n      const samplingHashKey = `SAMPLING:control_${flag.hashKey}:env_${\n        env.hashKey\n      }:rule_set_${this.population.hashKey}:client_object_${obj.type}_${obj.id}`\n\n      if (getHashedValue(samplingHashKey) <= this.population.percentage) {\n        if (this.population.percentage === 0) {\n          return {eligible: false}\n        }\n\n        const allocationHashKey = `DISTRIBUTION:control_${flag.hashKey}:env_${\n          env.hashKey\n        }:client_object_${obj.type}_${obj.id}`\n\n        const allocationHashedPercentage = getHashedValue(allocationHashKey)\n\n        let trailingSum = 0.0\n\n        const treatments = flag.treatments.filter(t => !t.isOffTreatment)\n\n        let treatment = null\n        for (let i = 0; i < treatments.length; i++) {\n          const t = treatments[i]\n          if (splitsMap.hasOwnProperty(t.treatmentId)) {\n            trailingSum = parseFloat(\n              (trailingSum + splitsMap[t.treatmentId].percentage).toFixed(3)\n            )\n\n            if (allocationHashedPercentage <= trailingSum) {\n              treatment = t\n              break\n            }\n          }\n        }\n\n        return {treatment: treatment, eligible: true}\n      } else {\n        return {eligible: true}\n      }\n    } else {\n      return {eligible: false}\n    }\n  }\n}\n","const NS_PER_SEC = 1e9\n\nexport default class Stat {\n  static compactStats(stats) {\n    const groups = stats.reduce((groups, stat) => {\n      const key = [stat.name, stat.type].join(',')\n      groups[key] = groups[key] || []\n      groups[key].push(stat)\n      return groups\n    }, {})\n\n    return Object.values(groups).map(stats => {\n      const newStat = new Stat(stats[0].name, stats[0].type)\n      let totalDuration, totalCount\n      switch (newStat.type) {\n        case Stat.TYPE_DURATION:\n          totalDuration = stats.reduce(\n            (duration, stat) => duration + stat.averageDuration * stat.count,\n            0\n          )\n          totalCount = stats.reduce((count, stat) => count + stat.count, 0)\n          newStat.setAverageDuration(totalDuration / totalCount)\n          newStat.setCount(totalCount)\n          break\n        case Stat.TYPE_COUNT:\n          newStat.setCount(stats.reduce((count, stat) => count + stat.count, 0))\n          break\n      }\n      return newStat\n    })\n  }\n\n  constructor(name, type) {\n    const allowedTypes = [Stat.TYPE_DURATION, Stat.TYPE_COUNT]\n    if (allowedTypes.indexOf(type) === -1) {\n      throw 'Invalid stat type passed'\n    }\n    this.name = name\n    this.type = type\n\n    this.count = 0\n    this.startTime = null\n\n    this.averageDuration = 0\n  }\n\n  start() {\n    if (this.averageDuration !== 0) {\n      throw 'Duration already calculated'\n    }\n\n    if (this.startTime !== null) {\n      throw 'Stat start() already called'\n    }\n\n    this.startTime = process.hrtime()\n    return this\n  }\n\n  stop() {\n    if (this.averageDuration !== 0) {\n      throw 'Duration already calculated'\n    }\n\n    if (this.startTime === null) {\n      throw 'Stat start() has not been called'\n    }\n\n    const stopTime = process.hrtime(this.startTime)\n    this.averageDuration = stopTime[0] * NS_PER_SEC + stopTime[1]\n    this.count = 1\n    return this\n  }\n\n  setCount(n) {\n    this.count = n\n    return this\n  }\n\n  setAverageDuration(t) {\n    this.averageDuration = t\n    return this\n  }\n\n  getDuration() {\n    return this.averageDuration\n  }\n\n  getStatsObj() {\n    const statsObj = {\n      name: this.name\n    }\n    if (this.type === Stat.TYPE_DURATION) {\n      if (this.averageDuration !== 0) {\n        statsObj.duration = this.averageDuration\n        statsObj.unit = 'ns'\n        statsObj.count = this.count\n        return statsObj\n      }\n    } else if (this.type === Stat.TYPE_COUNT) {\n      statsObj.count = this.count\n      return statsObj\n    }\n    return null\n  }\n}\n\nStat.TYPE_DURATION = 'stat_type__duration'\nStat.TYPE_COUNT = 'stat_type__count'\n","import {logger} from './logger'\n\nexport default class Flag {\n  constructor(flag, delegate) {\n    if (typeof flag === 'string') {\n      this._isWild = true\n      this.flagName = flag\n    } else {\n      // These along with flag.flagType and flag.flagStatus\n      // should always be present\n      this.hashKey = flag.hashKey\n      this.flag = flag\n      this.codename = flag.codename\n\n      // Pass through fields\n      this.isPaused = flag.isPaused\n      this.offTreatment = flag.offTreatment\n      this.treatments = flag.treatments\n      this.treatmentsMap = flag.treatmentsMap\n      this.overrides = flag.overrides\n      this.populations = flag.populations\n      this.splits = flag.splits\n    }\n    this.delegate = delegate\n  }\n\n  isUncategorized() {\n    return Boolean(this._isWild) || this.flag.flagType === 'uncategorized'\n  }\n\n  isWild() {\n    return Boolean(this._isWild)\n  }\n\n  isArchived() {\n    return this.flag.flagStatus === 'archived'\n  }\n\n  setDelegate(delegate) {\n    this.delegate = delegate\n  }\n\n  getType() {\n    if (this._isWild) {\n      logger(\n        `Encountered uncategorized flag \"${\n          this.flagName\n        }\". Visit Airship web app to convert it to a real flag`\n      )\n      return 'uncategorized'\n    }\n\n    const flagType = this.flag.flagType\n\n    switch (flagType) {\n      case 'basic':\n        return 'basic'\n      case 'experiment':\n        return 'experiment'\n      case 'uncategorized':\n        return 'uncategorized'\n      default:\n        logger('Unexpected flag type encountered')\n        return null\n    }\n  }\n\n  getTreatment(obj) {\n    if (!this.delegate) {\n      throw 'Delegate not provided to flag'\n    }\n    return this.delegate.getTreatment(this, obj)\n  }\n\n  getPayload(obj) {\n    if (!this.delegate) {\n      throw 'Delegate not provided to flag'\n    }\n    return this.delegate.getPayload(this, obj)\n  }\n\n  isEligible(obj) {\n    if (!this.delegate) {\n      throw 'Delegate not provided to flag'\n    }\n    return this.delegate.isEligible(this, obj)\n  }\n\n  isEnabled(obj) {\n    if (!this.delegate) {\n      throw 'Delegate not provided to flag'\n    }\n    return this.delegate.isEnabled(this, obj)\n  }\n}\n","import {logger} from './logger'\nimport AirshipObject from './object'\nimport Population from './population'\nimport Stat from './stat'\nimport Flag from './flag'\n\nexport default class Environment {\n  identify(obj) {\n    this.object = obj\n  }\n\n  async maybeIngest() {}\n\n  _identifyObject(obj) {\n    const airshipObj =\n      obj instanceof AirshipObject ? obj : new AirshipObject(obj)\n\n    return airshipObj\n  }\n\n  _saveStat() {}\n\n  _saveExposure() {}\n\n  async publish(objs) {} // eslint-disable-line no-unused-vars\n\n  shutdown() {}\n\n  flag(flagName) {\n    const flag = this.router\n      ? this.router.getFlag(flagName)\n      : new Flag(flagName)\n    flag.setDelegate(this)\n    return flag\n  }\n\n  _getAllocation(flag, airshipObj) {\n    const offTreatment = flag.offTreatment\n\n    if (flag.isArchived()) {\n      logger(`The flag \"${flag.codename}\" has been archived`)\n      return {\n        treatment: offTreatment,\n        eligible: false\n      }\n    }\n\n    if (flag.isPaused) {\n      return {\n        treatment: offTreatment,\n        eligible: false\n      }\n    }\n\n    // If the airshipObj is not a valid obj,\n    // then return the offTreatment/false\n    if (!airshipObj) {\n      return {\n        treatment: offTreatment,\n        eligible: false\n      }\n    }\n\n    const id = airshipObj.getId()\n    const override = flag.overrides[id]\n\n    if (override) {\n      const treatment = flag.treatmentsMap[override.treatmentId]\n      return {\n        treatment: treatment,\n        eligible: !treatment.isOffTreatment,\n        fromOverride: true\n      }\n    }\n\n    const obj = airshipObj.getRawObject()\n    const useUniverses = flag.getType() === 'experiment'\n    const populations = flag.populations\n    let treatment = null\n    let eligible = false\n\n    for (let i = 0; i < populations.length; i++) {\n      const p = new Population(populations[i])\n      const gateValues = p.getGateValues(\n        obj,\n        this.router.getEnv(),\n        flag,\n        useUniverses\n      )\n      eligible = eligible || gateValues.eligible\n      if (gateValues.treatment) {\n        treatment = gateValues.treatment\n        break\n      }\n    }\n\n    return {\n      treatment: treatment || offTreatment,\n      eligible: eligible\n    }\n  }\n\n  _resolveAllocations(alloc1, alloc2) {\n    if (alloc1.fromOverride) {\n      return alloc1\n    }\n\n    if (alloc2.fromOverride) {\n      return alloc2\n    }\n\n    if (!alloc1.treatment.isOffTreatment) {\n      return alloc1\n    }\n\n    if (!alloc2.treatment.isOffTreatment) {\n      return alloc2\n    }\n\n    return alloc1\n  }\n\n  _getExposure(flag, airshipObj, alloc, methodCalled) {\n    const obj = airshipObj.getRawObject()\n    return {\n      flag: flag.codename,\n      type: obj.type,\n      id: obj.id,\n      treatment: alloc.treatment.codename,\n      methodCalled: methodCalled,\n      eligible: alloc.eligible\n    }\n  }\n\n  getTreatment(flag, obj) {\n    const stat = new Stat('duration__get_treatment', Stat.TYPE_DURATION)\n    stat.start()\n    obj = obj || this.object\n\n    const airshipObj = this._identifyObject(obj)\n    if (!airshipObj.isValid() || flag.isUncategorized()) {\n      return 'off'\n    }\n\n    const allocation = this._getAllocation(flag, airshipObj)\n    const groupAllocation = this._getAllocation(flag, airshipObj.getGroup())\n\n    const finalAllocation = this._resolveAllocations(\n      allocation,\n      groupAllocation\n    )\n\n    const expo = this._getExposure(\n      flag,\n      airshipObj,\n      finalAllocation,\n      'getTreatment'\n    )\n    this._saveExposure(expo)\n\n    stat.stop()\n    this._saveStat(stat)\n    return finalAllocation.treatment.codename\n  }\n\n  getPayload(flag, obj) {\n    const stat = new Stat('duration__get_payload', Stat.TYPE_DURATION)\n    stat.start()\n    obj = obj || this.object\n    const airshipObj = this._identifyObject(obj)\n    if (!airshipObj.isValid() || flag.isUncategorized()) {\n      return null\n    }\n\n    const allocation = this._getAllocation(flag, airshipObj)\n    const groupAllocation = this._getAllocation(flag, airshipObj.getGroup())\n\n    const finalAllocation = this._resolveAllocations(\n      allocation,\n      groupAllocation\n    )\n\n    const expo = this._getExposure(\n      flag,\n      airshipObj,\n      finalAllocation,\n      'getPayload'\n    )\n    this._saveExposure(expo)\n\n    stat.stop()\n    this._saveStat(stat)\n    return finalAllocation.treatment.payload\n  }\n\n  isEligible(flag, obj) {\n    const stat = new Stat('duration__is_eligible', Stat.TYPE_DURATION)\n    stat.start()\n    obj = obj || this.object\n\n    const airshipObj = this._identifyObject(obj)\n    if (!airshipObj.isValid() || flag.isUncategorized()) {\n      return false\n    }\n\n    const allocation = this._getAllocation(flag, airshipObj)\n    const groupAllocation = this._getAllocation(flag, airshipObj.getGroup())\n\n    const finalAllocation = this._resolveAllocations(\n      allocation,\n      groupAllocation\n    )\n\n    const expo = this._getExposure(\n      flag,\n      airshipObj,\n      finalAllocation,\n      'isEligible'\n    )\n    this._saveExposure(expo)\n\n    stat.stop()\n    this._saveStat(stat)\n    return finalAllocation.eligible\n  }\n\n  isEnabled(flag, obj) {\n    const stat = new Stat('duration__is_enabled', Stat.TYPE_DURATION)\n    stat.start()\n    obj = obj || this.object\n\n    const airshipObj = this._identifyObject(obj)\n    if (!airshipObj.isValid() || flag.isUncategorized()) {\n      return false\n    }\n\n    const allocation = this._getAllocation(flag, airshipObj)\n    const groupAllocation = this._getAllocation(flag, airshipObj.getGroup())\n\n    const finalAllocation = this._resolveAllocations(\n      allocation,\n      groupAllocation\n    )\n\n    const expo = this._getExposure(\n      flag,\n      airshipObj,\n      finalAllocation,\n      'isEnabled'\n    )\n    this._saveExposure(expo)\n\n    stat.stop()\n    this._saveStat(stat)\n    return !finalAllocation.treatment.isOffTreatment\n  }\n}\n","// Based on https://chrisrng.svbtle.com/lru-cache-in-javascript\nclass LRUNode {\n  constructor(key, value) {\n    if (typeof key === 'undefined' || key === null) {\n      throw 'Cannot have an undefined or null key for a LRUNode'\n    }\n    if (typeof value === 'undefined' || value === null) {\n      throw 'Cannot have an undefined or null value for a LRUNode'\n    }\n    this.key = key\n    this.value = value\n    this.prev = null\n    this.next = null\n  }\n}\n\nexport default class LRU {\n  constructor(limit) {\n    this.size = 0\n    if (typeof limit === 'number') {\n      this.limit = limit\n    } else {\n      this.limit = 10\n    }\n    this.map = {}\n    this.head = null\n    this.tail = null\n  }\n\n  setHead(node) {\n    node.next = this.head\n    node.prev = null\n    if (this.head !== null) {\n      this.head.prev = node\n    }\n    this.head = node\n    if (this.tail === null) {\n      this.tail = node\n    }\n    this.size++\n    this.map[node.key] = node\n  }\n\n  set(key, value) {\n    const node = new LRUNode(key, value)\n    if (this.map[key]) {\n      this.map[key].value = node.value\n      this.remove(node.key)\n    } else {\n      if (this.size >= this.limit) {\n        delete this.map[this.tail.key]\n        this.size--\n        this.tail = this.tail.prev\n        this.tail.next = null\n      }\n    }\n    this.setHead(node)\n  }\n\n  get(key) {\n    if (this.map[key]) {\n      const value = this.map[key].value\n      const node = new LRUNode(key, value)\n      this.remove(key)\n      this.setHead(node)\n      return value\n    } else {\n      // console.log('Key ' + key + ' does not exist in the cache.')\n      return null // Return null because null cannot be a LRUNode value\n    }\n  }\n\n  remove(key) {\n    const node = this.map[key]\n    if (node.prev !== null) {\n      node.prev.next = node.next\n    } else {\n      this.head = node.next\n    }\n    if (node.next !== null) {\n      node.next.prev = node.prev\n    } else {\n      this.tail = node.prev\n    }\n    delete this.map[key]\n    this.size--\n  }\n\n  removeAll(limit) {\n    this.size = 0\n    this.map = {}\n    this.head = null\n    this.tail = null\n    if (typeof limit === 'number') {\n      this.limit = limit\n    }\n  }\n\n  forEach(callback) {\n    let node = this.head\n    let i = 0\n    while (node) {\n      callback(node, i)\n      i++\n      node = node.next\n    }\n  }\n}\n","import Flag from './flag'\n\nexport default class Router {\n  constructor(gatingInfo) {\n    this.gatingInfo = gatingInfo\n    this.gatingInfoMap = this._getGatingInfoMap(this.gatingInfo)\n  }\n\n  _getGatingInfoMap(gatingInfo) {\n    const map = {}\n\n    const flags = gatingInfo.flags\n\n    for (let i = 0; i < flags.length; i++) {\n      const flag = Object.assign({}, flags[i])\n      if (flag.flagType === 'uncategorized' || flag.flagStatus === 'archived') {\n        map[flag.codename] = new Flag(flag)\n        continue\n      }\n\n      const overrides = flag.overrides\n      const overridesMap = {}\n\n      for (let j = 0; j < overrides.length; j++) {\n        const override = overrides[j]\n\n        overridesMap[`${override.entityType}_${override.entityId}`] = override\n      }\n\n      flag.overrides = overridesMap\n\n      const treatments = flag.treatments\n      const treatmentsMap = {}\n      let offTreatment = null\n\n      for (let k = 0; k < treatments.length; k++) {\n        const treatment = treatments[k]\n\n        treatmentsMap[treatment.treatmentId] = treatment\n\n        if (treatment.isOffTreatment) {\n          offTreatment = treatment\n        }\n      }\n\n      flag.treatments = treatments\n      flag.treatmentsMap = treatmentsMap\n      flag.offTreatment = offTreatment\n\n      map[flag.codename] = new Flag(flag)\n    }\n\n    return map\n  }\n\n  getIngestionMaxItem() {\n    const sdkInfo = this.gatingInfo.sdkInfo\n    if (sdkInfo) {\n      return sdkInfo.SDK_INGESTION_MAX_ITEMS\n    }\n    return null\n  }\n\n  getIngestionInterval() {\n    const sdkInfo = this.gatingInfo.sdkInfo\n    if (sdkInfo) {\n      return sdkInfo.SDK_INGESTION_INTERVAL * 1000\n    }\n    return null\n  }\n\n  getShouldIngestObjects() {\n    const sdkInfo = this.gatingInfo.sdkInfo\n    if (sdkInfo && typeof sdkInfo.SDK_SHOULD_INGEST_OBJECTS === 'boolean') {\n      return sdkInfo.SDK_SHOULD_INGEST_OBJECTS\n    }\n    return null\n  }\n\n  getShouldIngestStats() {\n    const sdkInfo = this.gatingInfo.sdkInfo\n    if (sdkInfo && typeof sdkInfo.SDK_SHOULD_INGEST_STATS === 'boolean') {\n      return sdkInfo.SDK_SHOULD_INGEST_STATS\n    }\n    return null\n  }\n\n  getShouldIngestExposures() {\n    const sdkInfo = this.gatingInfo.sdkInfo\n    if (sdkInfo && typeof sdkInfo.SDK_SHOULD_INGEST_EXPOSURES === 'boolean') {\n      return sdkInfo.SDK_SHOULD_INGEST_EXPOSURES\n    }\n    return null\n  }\n\n  getShouldIngestFlags() {\n    const sdkInfo = this.gatingInfo.sdkInfo\n    if (sdkInfo && typeof sdkInfo.SDK_SHOULD_INGEST_FLAGS === 'boolean') {\n      return sdkInfo.SDK_SHOULD_INGEST_FLAGS\n    }\n    return null\n  }\n\n  getFlag(flagName) {\n    return this.gatingInfoMap[flagName] || new Flag(flagName)\n  }\n\n  getEnv() {\n    return this.gatingInfo.env\n  }\n\n  isLocallyConfigured() {\n    return this.getEnv().envKey === null\n  }\n}\n","import EventSource from 'eventsource'\nimport Environment from './environment'\nimport {logger} from './logger'\nimport LRU from './lru'\nimport Router from './router'\nimport Stat from './stat'\nimport {version} from '../package.json'\n\nimport * as http from 'http'\nimport * as https from 'https'\nimport * as URL from 'url'\n\nconst SERVER_URL = 'https://api.airshiphq.com'\nconst IDENTIFY_ENDPOINT = `${SERVER_URL}/v2/identify`\nconst GATING_INFO_ENDPOINT = `${SERVER_URL}/v2/gating-info`\n\nconst SSE_URL = 'https://sse.airshiphq.com'\nconst SSE_GATING_INFO_ENDPOINT = `${SSE_URL}/v2/sse-events`\n\nconst CLOUD_FRONT_URL = 'https://backup-api.airshiphq.com'\nconst CLOUD_FRONT_GATING_INFO_ENDPOINT = `${CLOUD_FRONT_URL}/v2/gating-info`\n\nconst REQUEST_TIMEOUT = 10 * 1000\n\nexport default class Airship extends Environment {\n  constructor(gatingInfoListener) {\n    super()\n\n    this.gatingInfoListener = gatingInfoListener\n    this.init()\n  }\n\n  init() {\n    this.ingestionMaxItems = 500\n    this.ingestionInterval = 30 * 1000\n\n    this.objects = []\n    this.stats = []\n    this.exposures = []\n    this.flags = new Set()\n    this.oldFlags = new Set()\n\n    this.objectLRUCache = new LRU(500)\n    this.firstIngestion = true\n\n    this.shouldIngestObjects = true\n    this.shouldIngestStats = true\n    this.shouldIngestExposures = true\n    this.shouldIngestFlags = true\n\n    this.restartIngestionWorker()\n  }\n\n  restartIngestionWorker() {\n    if (this.ingestionWorker) {\n      clearInterval(this.ingestionWorker)\n    }\n\n    this.ingestionWorker = setInterval(() => {\n      this.maybeIngest(true)\n    }, this.ingestionInterval)\n  }\n\n  async maybeIngest(force = false) {\n    if (!this.shouldIngestObjects) {\n      this.objects = []\n    }\n\n    if (!this.shouldIngestStats) {\n      this.stats = []\n    }\n\n    if (!this.shouldIngestExposures) {\n      this.exposures = []\n    }\n\n    if (!this.shouldIngestFlags) {\n      this.flags = new Set()\n    }\n\n    let shouldIngest =\n      force ||\n      (this.objects.length >= this.ingestionMaxItems ||\n        this.stats.length >= this.ingestionMaxItems ||\n        this.exposures.length >= this.ingestionMaxItems ||\n        this.flags.size > 0)\n\n    if (this.firstIngestion) {\n      shouldIngest = shouldIngest || this.objects.length > 0\n      this.firstIngestion = !shouldIngest\n    }\n\n    if (\n      this.objects.length === 0 &&\n      this.stats.length === 0 &&\n      this.exposures.length === 0 &&\n      this.flags.size === 0\n    ) {\n      shouldIngest = false\n    }\n\n    if (shouldIngest) {\n      const objects = this.objects\n      const stats = this.stats\n      const exposures = this.exposures\n      const flags = Array.from(this.flags)\n      flags.forEach(flagName => {\n        this.oldFlags.add(flagName)\n      })\n\n      this.objects = []\n      this.stats = []\n      this.exposures = []\n      this.flags = new Set()\n\n      await this.postContent(\n        IDENTIFY_ENDPOINT + '/' + this.envKey,\n        JSON.stringify({\n          objects: objects,\n          stats: stats.map(s => s.getStatsObj()).filter(so => so !== null),\n          exposures: exposures,\n          flags: flags,\n          sdkInfo: {\n            name: '__SDK_NAME__',\n            version: version\n          }\n        })\n      ).catch(err => {\n        logger(err)\n      })\n    }\n  }\n\n  _identifyObject(obj) {\n    const airshipObj = Environment.prototype._identifyObject.call(this, obj)\n\n    if (!airshipObj.isValid()) {\n      return airshipObj\n    }\n    const id = airshipObj.getId()\n    const hash = airshipObj.getHash()\n    const storedHash = this.objectLRUCache.get(id)\n    if (storedHash === null || hash !== storedHash) {\n      this.objects.push(airshipObj.getRawObject())\n    }\n\n    this.objectLRUCache.set(id, hash)\n    this.maybeIngest()\n\n    return airshipObj\n  }\n\n  _compactStats() {\n    this.stats = Stat.compactStats(this.stats)\n  }\n\n  _saveStat(stat) {\n    this.stats.push(stat)\n    if (this.stats.length >= this.ingestionMaxItems) {\n      this._compactStats()\n    }\n    this.maybeIngest()\n  }\n\n  _saveExposure(expo) {\n    this.exposures.push(expo)\n    this.maybeIngest()\n  }\n\n  async publish(objs) {\n    if (!Array.isArray(objs)) {\n      logger('The \"publish\" method takes an array of objects (aka entities).')\n      return\n    }\n\n    objs.forEach(obj => {\n      this._identifyObject(obj)\n    })\n\n    await this.maybeIngest(true)\n  }\n\n  getContent(url, timeout = REQUEST_TIMEOUT) {\n    return new Promise((resolve, reject) => {\n      const urlObj = URL.parse(url)\n\n      const lib = urlObj.protocol === 'https:' ? https : http\n\n      const request = lib.get(url, response => {\n        if (response.statusCode < 200 || response.statusCode > 299) {\n          reject('Failed to load page, status code: ' + response.statusCode)\n        }\n        const body = []\n\n        response.on('data', chunk => body.push(chunk))\n\n        response.on('end', () => {\n          resolve(body.join(''))\n        })\n      })\n\n      request.on('error', err => reject(err))\n\n      request.setTimeout(timeout, () => {\n        request.abort()\n        reject('Request timed out')\n      })\n    })\n  }\n\n  postContent(\n    url,\n    data,\n    contentType = 'application/json',\n    timeout = REQUEST_TIMEOUT\n  ) {\n    return new Promise((resolve, reject) => {\n      const urlObj = URL.parse(url)\n\n      const lib = urlObj.protocol === 'https:' ? https : http\n\n      const options = {\n        protocol: urlObj.protocol,\n        hostname: urlObj.hostname,\n        port: urlObj.port,\n        path: urlObj.path,\n        method: 'POST',\n        headers: {\n          'Content-Type': contentType,\n          'Content-Length': Buffer.byteLength(data)\n        }\n      }\n      const request = lib.request(options, response => {\n        if (response.statusCode < 200 || response.statusCode > 299) {\n          reject('Failed to post to url, status code: ' + response.statusCode)\n        }\n\n        const body = []\n\n        response.on('data', chunk => body.push(chunk))\n\n        response.on('end', () => resolve(body.join('')))\n      })\n\n      request.on('error', err => {\n        reject(err)\n      })\n\n      request.setTimeout(timeout, () => {\n        request.abort()\n        reject('Request timed out')\n      })\n\n      request.write(data)\n      request.end()\n    })\n  }\n\n  async _getGatingInfo() {\n    const body = await this.getContent(\n      `${GATING_INFO_ENDPOINT}/${this.envKey}?casing=camel`\n    )\n    return JSON.parse(body)\n  }\n\n  async _getGatingInfoFromCloudFront() {\n    const body = await this.getContent(\n      `${CLOUD_FRONT_GATING_INFO_ENDPOINT}/${this.envKey}-camel`\n    )\n    return JSON.parse(body)\n  }\n\n  updateSDK() {\n    const ingestionMaxItems = this.router.getIngestionMaxItem()\n    const ingestionInterval = this.router.getIngestionInterval()\n    const shouldIngestObjects = this.router.getShouldIngestObjects()\n    const shouldIngestStats = this.router.getShouldIngestStats()\n    const shouldIngestExposures = this.router.getShouldIngestExposures()\n    const shouldIngestFlags = this.router.getShouldIngestFlags()\n\n    if (typeof ingestionMaxItems === 'number' && ingestionMaxItems > 0) {\n      this.ingestionMaxItems = ingestionMaxItems\n    }\n    if (\n      typeof ingestionInterval === 'number' &&\n      ingestionInterval > 0 &&\n      ingestionInterval != this.ingestionInterval\n    ) {\n      this.ingestionInterval = ingestionInterval\n      this.restartIngestionWorker()\n    }\n    if (typeof shouldIngestObjects === 'boolean') {\n      this.shouldIngestObjects = shouldIngestObjects\n    }\n    if (typeof shouldIngestStats === 'boolean') {\n      this.shouldIngestStats = shouldIngestStats\n    }\n    if (typeof shouldIngestExposures === 'boolean') {\n      this.shouldIngestExposures = shouldIngestExposures\n    }\n    if (typeof shouldIngestFlags === 'boolean') {\n      this.shouldIngestFlags = shouldIngestFlags\n    }\n  }\n\n  async configure(envKey, subscribeToUpdates = true) {\n    const envKeyRegex = /^[a-z0-9]{16}$/\n    if (!envKey.match(envKeyRegex)) {\n      throw 'options[\"envKey\"] should be a string of lowercase characters and digits. Double check on the Airship web app.'\n    }\n\n    this.envKey = envKey\n    this.subscribeToUpdates = subscribeToUpdates\n    this.init()\n\n    this.success = null\n\n    // First try our server\n    try {\n      const stat = new Stat('duration__gating_info', Stat.TYPE_DURATION)\n      stat.start()\n      const result = await this._getGatingInfo()\n      const gatingInfo = result\n      this.router = new Router(gatingInfo)\n      this.updateSDK()\n      if (this.gatingInfoListener) {\n        this.gatingInfoListener(gatingInfo)\n      }\n      this.success = true\n      stat.stop()\n      this._saveStat(stat)\n    } catch (err) {\n      logger(err)\n    }\n\n    // Next try CloudFront distribution\n    if (!this.success) {\n      try {\n        const stat = new Stat(\n          'duration__cloudfront_gating_info',\n          Stat.TYPE_DURATION\n        )\n        stat.start()\n        const result = await this._getGatingInfoFromCloudFront()\n        const gatingInfo = result\n        this.router = new Router(gatingInfo)\n        this.updateSDK()\n        if (this.gatingInfoListener) {\n          this.gatingInfoListener(gatingInfo)\n        }\n        this.success = true\n        stat.stop()\n        this._saveStat(stat)\n      } catch (err) {\n        logger(err)\n        this.success = false\n      }\n    }\n\n    if (!this.success) {\n      throw 'Failed to retrieve initial gating information'\n    }\n\n    if (subscribeToUpdates) {\n      this._subscribeToUpdates()\n      this._policeSSE()\n    }\n  }\n\n  async shutdown() {\n    if (this.ingestionWorker) {\n      clearInterval(this.ingestionWorker)\n    }\n\n    this._unpoliceSSE()\n    this._unsubscribeFromUpdates()\n\n    await this.maybeIngest(true)\n  }\n\n  flag(flagName) {\n    const flag = Environment.prototype.flag.call(this, flagName)\n    if (flag.isWild()) {\n      // Register the new uncategorized flag\n      if (!this.oldFlags.has(flagName)) {\n        this.flags.add(flagName)\n        this.maybeIngest()\n      }\n    }\n    return flag\n  }\n\n  _policeSSE() {\n    this._unpoliceSSE()\n    this.policeSSEInterval = setInterval(() => {\n      const now = Date.now()\n      const then = this.lastSSEConnectTimestamp || Date.now()\n      if ((now - then) / 1000 > 30) {\n        logger(\n          'Did not receive a keepalive for more than 30 seconds. Reconnecting.'\n        )\n        this._subscribeToUpdates()\n      }\n    }, 5 * 1000)\n  }\n\n  _unpoliceSSE() {\n    if (this.policeSSEInterval) {\n      clearInterval(this.policeSSEInterval)\n      delete this.policeSSEInterval\n\n      if (this.lastSSEConnectTimestamp) {\n        delete this.lastSSEConnectTimestamp\n      }\n    }\n  }\n\n  _subscribeToUpdates() {\n    this._unsubscribeFromUpdates()\n\n    this.eventSource = new EventSource(\n      `${SSE_GATING_INFO_ENDPOINT}?envkey=${this.envKey}&casing=camel`\n    )\n    this.eventSource.addEventListener('gatingInfoUpdate', evt => {\n      const gatingInfo = JSON.parse(evt.data)\n      this.router = new Router(gatingInfo)\n      this.updateSDK()\n      if (this.gatingInfoListener) {\n        this.gatingInfoListener(gatingInfo)\n      }\n      this.lastSSEConnectTimestamp = Date.now()\n    })\n\n    this.eventSource.addEventListener('keepalive', () => {\n      this.lastSSEConnectTimestamp = Date.now()\n    })\n  }\n\n  _unsubscribeFromUpdates() {\n    if (this.eventSource) {\n      this.eventSource.close()\n      delete this.eventSource\n    }\n  }\n}\n","import {logger} from '../logger'\nimport Ajv from 'ajv'\nimport ajvErrors from 'ajv-errors'\n\nconst SCHEMA = {\n  type: 'object',\n  patternProperties: {\n    '^.{1,150}$': {\n      type: 'object',\n      properties: {\n        whitelist: {\n          type: 'array',\n          items: {\n            type: ['integer', 'string'],\n            errorMessage: {\n              type:\n                'An ID can be a string or integer. Integer ID will be cast into a string.'\n            }\n          },\n          errorMessage: {\n            type: '`whitelist` must be an array of IDs (string|integer)'\n          }\n        },\n        blacklist: {\n          type: 'array',\n          items: {\n            type: ['integer', 'string'],\n            errorMessage: {\n              type:\n                'An ID can be a string or integer. Integer ID will be cast into a string.'\n            }\n          },\n          errorMessage: {\n            type: '`blacklist` must be an array of IDs (string|integer)'\n          }\n        },\n        population: {\n          type: 'array',\n          items: {\n            type: 'object',\n            properties: {\n              attribute: {\n                type: 'string',\n                maxLength: 50,\n                errorMessage: {\n                  type:\n                    'A population\\'s filter attribute must be a string of 50 characters or less. E.g., \"age\", \"height\", \"birthDate\", etc.',\n                  maxLength:\n                    'A population\\'s filter attribute must be a string of 50 characters or less. E.g., \"age\", \"height\", \"birthDate\", etc.'\n                }\n              },\n              operator: {\n                type: 'string',\n                enum: [\n                  'is',\n                  'is_not',\n                  'in',\n                  'not_in',\n                  'lt',\n                  'lte',\n                  'gt',\n                  'gte',\n                  'from',\n                  'until',\n                  'after',\n                  'before'\n                ],\n                errorMessage: {\n                  type:\n                    'A population\\'s filter operator must be a string and must be one of: [\"is\", \"is_not\", \"in\", \"not_in\", \"lt\", \"lte\", \"gt\", \"gte\", \"from\", \"until\", \"after\", \"before\"]',\n                  enum:\n                    'A population\\'s filter operator must be a string and must be one of: [\"is\", \"is_not\", \"in\", \"not_in\", \"lt\", \"lte\", \"gt\", \"gte\", \"from\", \"until\", \"after\", \"before\"]'\n                }\n              },\n              value: {\n                type: ['number', 'string', 'boolean', 'array'],\n                maxLength: 3000,\n                items: {\n                  oneOf: [\n                    {\n                      type: 'number',\n                      errorMessage: {\n                        type:\n                          \"A population's filter valueList must contain numbers or strings.\"\n                      }\n                    },\n                    {\n                      type: 'string',\n                      maxLength: 3000,\n                      errorMessage: {\n                        maxLength:\n                          'A string value for a population filter must be 3000 characters or less'\n                      }\n                    }\n                  ]\n                },\n                minItems: 1,\n                errorMessage: {\n                  type:\n                    \"A population's filter value is a number, string, or boolean or an array of numbers or strings.\",\n                  maxLength:\n                    'A string value for a population filter must be 3000 characters or less',\n                  minItems:\n                    \"A population's filter value must have at least one item if it is an array.\"\n                }\n              }\n            },\n            errorMessage: {\n              type:\n                'Each filter within a population is represented by an object of the form: {attribute: <attribute>, operator: <operator>, value/valueList: <value>/<valueList>}'\n            }\n          },\n          errorMessage: {\n            type:\n              '`population` must be an array of filters, each of the form: {attribute: <attribute>, operator: <operator>, value/valueList: <value>/<valueList>}'\n          }\n        },\n        sample: {\n          type: 'number',\n          minimum: 0.0,\n          maximum: 1.0,\n          errorMessage: {\n            type: '`sample` must be a float between 0.0 and 1.0, inclusive',\n            minimum: '`sample` must be between 0.0 and 1.0, inclusive',\n            maximum: '`sample` must be between 0.0 and 1.0, inclusive'\n          }\n        },\n        active: {\n          type: 'boolean',\n          errorMessage: {\n            type: '`active` must be a boolean'\n          }\n        }\n      },\n      additionalProperties: false,\n      errorMessage: {\n        type:\n          'flagConfig must be a dictionary of flag name keys to flag configuration values',\n        additionalProperties:\n          'Unexpected config option found. Please refer to the documentation.'\n      }\n    }\n  },\n  errorMessage: {\n    patternProperties: 'Flag name must be strings of up to 150 characters.'\n  }\n}\n\nconst ajv = Ajv({allErrors: true, jsonPointers: true})\najvErrors(ajv)\nconst validate = ajv.compile(SCHEMA)\n\nexport const isValidFlagConfig = flagConfig => {\n  const isValid = validate(flagConfig)\n  if (!isValid) {\n    logger(validate.errors.map(e => e.message))\n  }\n  return isValid\n}\n","import {logger} from '../logger'\nimport {isValidFlagConfig} from '../validators/core_validator'\nimport Population, {\n  RULE_TYPE_STRING,\n  RULE_TYPE_INT,\n  RULE_TYPE_FLOAT,\n  RULE_TYPE_BOOLEAN,\n  RULE_TYPE_DATE,\n  RULE_TYPE_DATETIME,\n  RULE_OPERATOR_IS,\n  RULE_OPERATOR_IS_NOT,\n  RULE_OPERATOR_IN,\n  RULE_OPERATOR_NOT_IN,\n  RULE_OPERATOR_LT,\n  RULE_OPERATOR_LTE,\n  RULE_OPERATOR_GT,\n  RULE_OPERATOR_GTE,\n  RULE_OPERATOR_FROM,\n  RULE_OPERATOR_UNTIL,\n  RULE_OPERATOR_AFTER,\n  RULE_OPERATOR_BEFORE\n} from '../population'\n\nconst RULE_TYPE_TO_ALLOWED_OPERATORS = {\n  [RULE_TYPE_STRING]: new Set([\n    RULE_OPERATOR_IS,\n    RULE_OPERATOR_IS_NOT,\n    RULE_OPERATOR_IN,\n    RULE_OPERATOR_NOT_IN\n  ]),\n  [RULE_TYPE_INT]: new Set([\n    RULE_OPERATOR_IS,\n    RULE_OPERATOR_IS_NOT,\n    RULE_OPERATOR_IN,\n    RULE_OPERATOR_NOT_IN,\n    RULE_OPERATOR_LT,\n    RULE_OPERATOR_LTE,\n    RULE_OPERATOR_GT,\n    RULE_OPERATOR_GTE\n  ]),\n  [RULE_TYPE_FLOAT]: new Set([\n    RULE_OPERATOR_IS,\n    RULE_OPERATOR_IS_NOT,\n    RULE_OPERATOR_IN,\n    RULE_OPERATOR_NOT_IN,\n    RULE_OPERATOR_LT,\n    RULE_OPERATOR_LTE,\n    RULE_OPERATOR_GT,\n    RULE_OPERATOR_GTE\n  ]),\n  [RULE_TYPE_BOOLEAN]: new Set([RULE_OPERATOR_IS, RULE_OPERATOR_IS_NOT]),\n  [RULE_TYPE_DATE]: new Set([\n    RULE_OPERATOR_IS,\n    RULE_OPERATOR_IS_NOT,\n    RULE_OPERATOR_IN,\n    RULE_OPERATOR_NOT_IN,\n    RULE_OPERATOR_FROM,\n    RULE_OPERATOR_UNTIL,\n    RULE_OPERATOR_AFTER,\n    RULE_OPERATOR_BEFORE\n  ]),\n  [RULE_TYPE_DATETIME]: new Set([\n    RULE_OPERATOR_IS,\n    RULE_OPERATOR_IS_NOT,\n    RULE_OPERATOR_IN,\n    RULE_OPERATOR_NOT_IN,\n    RULE_OPERATOR_FROM,\n    RULE_OPERATOR_UNTIL,\n    RULE_OPERATOR_AFTER,\n    RULE_OPERATOR_BEFORE\n  ])\n}\n\nexport const transformFlagConfig = flagConfig => {\n  if (!isValidFlagConfig(flagConfig)) {\n    return null\n  }\n\n  const flags = []\n  const keys = Object.keys(flagConfig)\n  for (let i = 0; i < keys.length; i++) {\n    const key = keys[i]\n    const config = flagConfig[key]\n    const active = config.active !== undefined ? config.active : true\n    const flagInfo = {\n      flagType: 'basic',\n      hashKey: key,\n      isPaused: !active,\n      isWebAccessible: __BROWSER__, // eslint-disable-line no-undef\n      codename: key,\n      flagStatus: 'operational'\n    }\n    const whitelist = config.whitelist || []\n    const blacklist = config.blacklist || []\n    const blacklistSet = new Set(blacklist)\n    const filteredWhitelist = whitelist.filter(i => !blacklistSet.has(i))\n\n    flagInfo.treatments = [\n      {\n        treatmentId: 'off-treatment',\n        codename: 'off',\n        isControl: false,\n        isOffTreatment: true\n      },\n      {\n        treatmentId: 'on-treatment',\n        codename: 'on',\n        isControl: false,\n        isOffTreatment: false\n      }\n    ]\n\n    flagInfo.overrides = []\n\n    flagInfo.overrides = flagInfo.overrides.concat(\n      filteredWhitelist.map(i => ({\n        treatmentId: 'on-treatment',\n        entityType: 'User',\n        entityId: i.toString()\n      }))\n    )\n\n    flagInfo.overrides = flagInfo.overrides.concat(\n      blacklist.map(i => ({\n        treatmentId: 'off-treatment',\n        entityType: 'User',\n        entityId: i.toString()\n      }))\n    )\n\n    flagInfo.splits = [{treatmentId: 'on-treatment', percentage: 1}]\n\n    if (config.population) {\n      const rules = config.population || []\n      const ruleInfos = []\n\n      for (let j = 0; j < rules.length; j++) {\n        const r = rules[j]\n        let type\n        if (Array.isArray(r.value)) {\n          const types = new Set(\n            r.value.map(v => Population.categorizeValueType(v))\n          )\n\n          if (types.size != 1) {\n            logger(\n              \"Population's filter criteria each should have a singular value type. In other words, do not mix strings with numbers in the same array, for example.\"\n            )\n            return null\n          }\n\n          type = Array.from(types)[0]\n        } else {\n          type = Population.categorizeValueType(r.value)\n        }\n\n        const rInfo = {\n          attributeName: r.attribute,\n          attributeType: type,\n          operator: r.operator,\n          value: !Array.isArray(r.value) ? r.value : null,\n          valueList: !Array.isArray(r.value) ? null : r.value\n        }\n\n        if (!RULE_TYPE_TO_ALLOWED_OPERATORS[type].has(r.operator)) {\n          logger(\n            `Population's filter operator \\`${\n              r.operator\n            }\\` is not allowed for filter type \\`${type}\\``\n          )\n          return null\n        }\n\n        if (rInfo.valueList) {\n          if (\n            rInfo.operator !== RULE_OPERATOR_IN &&\n            rInfo.operator !== RULE_OPERATOR_NOT_IN\n          ) {\n            logger(\n              \"Population's filter operator must be `in` or `not_in` if the value is an array.\"\n            )\n            return null\n          }\n        } else {\n          if (\n            rInfo.operator === RULE_OPERATOR_IN &&\n            rInfo.operator === RULE_OPERATOR_NOT_IN\n          ) {\n            logger(\n              \"Population's filter operator must not be `in` or `not_in` if the value is a number, boolean or string.\"\n            )\n            return null\n          }\n        }\n\n        ruleInfos.push(rInfo)\n      }\n\n      flagInfo.populations = [\n        {\n          hashKey: 'population-1',\n          entityType: 'User',\n          percentage: config.sample || 0.0,\n          rules: ruleInfos,\n          universes: []\n        }\n      ]\n    } else {\n      flagInfo.populations = [\n        {\n          hashKey: 'population-1',\n          entityType: 'User',\n          percentage: config.sample || 0.0,\n          rules: [],\n          universes: []\n        }\n      ]\n    }\n\n    flags.push(flagInfo)\n  }\n\n  return {\n    flags: flags,\n    env: {\n      hashKey: 'env-1',\n      envKey: null\n    }\n  }\n}\n","import Environment from './environment'\nimport Router from './router'\nimport {transformFlagConfig} from './transformers/core_transformer'\n\nexport default class Core extends Environment {\n  async configure(flagConfig) {\n    const gatingInfo = transformFlagConfig(flagConfig)\n    if (gatingInfo === null) {\n      throw 'Failed to transform flagConfig into initial gating information'\n    }\n    this.router = new Router(gatingInfo)\n  }\n}\n","import {setLogger} from './logger'\nimport Airship from './airship'\nimport Core from './core'\n\nconst defaultEnv = new Core()\ndefaultEnv.configure({})\n\nexport class FlaggerBase {\n  constructor() {\n    this.gatingInfoListeners = []\n  }\n\n  static _isDict(obj) {\n    return obj !== undefined && obj !== null && obj.constructor === Object\n  }\n\n  async publish(objs) {\n    if (this.environment) {\n      await this.environment.publish(objs)\n    } else {\n      throw 'Airship must be configured first before `publish` can be called'\n    }\n  }\n\n  // This will allow for async/await\n  async configure(options) {\n    if (!FlaggerBase._isDict(options)) {\n      throw '<options> must be dictionary'\n    }\n\n    const envKey = options.envKey\n    const flagConfig = options.flagConfig\n\n    if (!envKey && !flagConfig) {\n      throw '<options> must contain envKey corresponding to an environment key or a flagConfig dictionary'\n    }\n\n    const subscribeToUpdates =\n      options.subscribeToUpdates === false ? false : true\n\n    if (envKey) {\n      if (\n        this.environment &&\n        this.environment.envKey === envKey &&\n        this.environment.subscribeToUpdates === subscribeToUpdates &&\n        this.environment.environmentPromise &&\n        this.environment.success !== false\n      ) {\n        await this.environment.environmentPromise\n      } else {\n        if (this.environment) {\n          await this.environment.shutdown()\n        }\n        this.environment = new Airship(this.handleGatingInfoUpdate.bind(this))\n        const promise = this.environment.configure(\n          envKey,\n          options.subscribeToUpdates\n        )\n        this.environment.environmentPromise = promise\n        await promise\n      }\n    } else {\n      if (this.environment) {\n        await this.environment.shutdown()\n      }\n      this.environment = new Core()\n      await this.environment.configure(flagConfig)\n    }\n  }\n\n  async shutdown() {\n    if (this.environment) {\n      await this.environment.shutdown()\n      delete this.environment\n    } else {\n      throw 'Airship must be configured first before `shutdown` can be called'\n    }\n  }\n\n  flag(flagName) {\n    return (this.environment || defaultEnv).flag(flagName)\n  }\n\n  setErrorListener(fn) {\n    setLogger(fn)\n  }\n\n  handleGatingInfoUpdate(gatingInfo) {\n    this.gatingInfoListeners.forEach(listener => listener(gatingInfo))\n  }\n\n  addGatingInfoListener(listener) {\n    this.gatingInfoListeners.push(listener)\n  }\n\n  removeGatingInfoListener(listener) {\n    this.gatingInfoListeners = this.gatingInfoListeners.filter(\n      l => l !== listener\n    )\n  }\n\n  identify(obj) {\n    if (this.environment) {\n      this.environment.identify(obj)\n      this.environment._identifyObject(obj)\n      this.environment.maybeIngest(true)\n    } else {\n      throw 'Airship must be configured first before `identify` can be called'\n    }\n  }\n}\n\nconst Flagger = new FlaggerBase()\n\nexport default Flagger\n"],"names":["logger","x","console","error","setLogger","fn","SCHEMA","type","properties","pattern","maxLength","minLength","errorMessage","isGroup","id","displayName","attributes","patternProperties","oneOf","maxProperties","additionalProperties","group","enum","required","ajv","Ajv","allErrors","jsonPointers","ajvErrors","validate","compile","DEFAULT_ENTITY_TYPE","AirshipObject","constructor","obj","isValid","isValidObject","object","_cloneObject","_fillInFields","errors","map","e","message","undefined","groupIndex","lastIndexOf","length","clone","Object","assign","Number","isInteger","idStr","getHash","md5","stringify","getId","getRawObject","getObject","getGroup","RULE_TYPE_STRING","RULE_TYPE_INT","RULE_TYPE_FLOAT","RULE_TYPE_BOOLEAN","RULE_TYPE_DATE","RULE_TYPE_DATETIME","RULE_OPERATOR_IS","RULE_OPERATOR_IS_NOT","RULE_OPERATOR_IN","RULE_OPERATOR_NOT_IN","RULE_OPERATOR_LT","RULE_OPERATOR_LTE","RULE_OPERATOR_GT","RULE_OPERATOR_GTE","RULE_OPERATOR_FROM","RULE_OPERATOR_UNTIL","RULE_OPERATOR_AFTER","RULE_OPERATOR_BEFORE","getHashedValue","s","parseInt","Population","population","categorizeValueType","v","indexOf","unixTimestamp","Date","getTime","isNaN","isoFormat","toISOString","timeIndex","_ruleMatches","rule","hasOwnProperty","attributeName","attributeType","numberTypes","targetVal","value","targetValList","valueList","op","operator","targetTime","targetTimeList","tv","vTime","getGateValues","env","flag","sticky","entityType","eligible","splits","universes","Math","floor","percentage","splitsMap","i","split","treatmentId","rules","matches","r","samplingHashKey","hashKey","allocationHashKey","allocationHashedPercentage","trailingSum","treatments","filter","t","isOffTreatment","treatment","parseFloat","toFixed","NS_PER_SEC","Stat","compactStats","stats","groups","reduce","stat","key","name","join","push","values","newStat","totalDuration","totalCount","TYPE_DURATION","duration","averageDuration","count","setAverageDuration","setCount","TYPE_COUNT","allowedTypes","startTime","start","process","hrtime","stop","stopTime","n","getDuration","getStatsObj","statsObj","unit","Flag","delegate","_isWild","flagName","codename","isPaused","offTreatment","treatmentsMap","overrides","populations","isUncategorized","Boolean","flagType","isWild","isArchived","flagStatus","setDelegate","getType","getTreatment","getPayload","isEligible","isEnabled","Environment","identify","maybeIngest","_identifyObject","airshipObj","_saveStat","_saveExposure","publish","objs","shutdown","router","getFlag","_getAllocation","override","fromOverride","useUniverses","p","gateValues","getEnv","_resolveAllocations","alloc1","alloc2","_getExposure","alloc","methodCalled","allocation","groupAllocation","finalAllocation","expo","payload","LRUNode","prev","next","LRU","limit","size","head","tail","setHead","node","set","remove","get","removeAll","forEach","callback","Router","gatingInfo","gatingInfoMap","_getGatingInfoMap","flags","overridesMap","j","entityId","k","getIngestionMaxItem","sdkInfo","SDK_INGESTION_MAX_ITEMS","getIngestionInterval","SDK_INGESTION_INTERVAL","getShouldIngestObjects","SDK_SHOULD_INGEST_OBJECTS","getShouldIngestStats","SDK_SHOULD_INGEST_STATS","getShouldIngestExposures","SDK_SHOULD_INGEST_EXPOSURES","getShouldIngestFlags","SDK_SHOULD_INGEST_FLAGS","isLocallyConfigured","envKey","SERVER_URL","IDENTIFY_ENDPOINT","GATING_INFO_ENDPOINT","SSE_URL","SSE_GATING_INFO_ENDPOINT","CLOUD_FRONT_URL","CLOUD_FRONT_GATING_INFO_ENDPOINT","REQUEST_TIMEOUT","Airship","gatingInfoListener","init","ingestionMaxItems","ingestionInterval","objects","exposures","Set","oldFlags","objectLRUCache","firstIngestion","shouldIngestObjects","shouldIngestStats","shouldIngestExposures","shouldIngestFlags","restartIngestionWorker","ingestionWorker","clearInterval","setInterval","force","shouldIngest","Array","from","add","postContent","JSON","so","version","catch","err","prototype","call","hash","storedHash","_compactStats","isArray","getContent","url","timeout","Promise","resolve","reject","urlObj","URL","lib","protocol","https","http","request","response","statusCode","body","on","chunk","setTimeout","abort","data","contentType","options","hostname","port","path","method","headers","Buffer","byteLength","write","end","_getGatingInfo","parse","_getGatingInfoFromCloudFront","updateSDK","configure","subscribeToUpdates","envKeyRegex","match","success","result","_subscribeToUpdates","_policeSSE","_unpoliceSSE","_unsubscribeFromUpdates","has","policeSSEInterval","now","then","lastSSEConnectTimestamp","eventSource","EventSource","addEventListener","evt","close","whitelist","items","blacklist","attribute","minItems","sample","minimum","maximum","active","isValidFlagConfig","flagConfig","RULE_TYPE_TO_ALLOWED_OPERATORS","transformFlagConfig","keys","config","flagInfo","isWebAccessible","blacklistSet","filteredWhitelist","isControl","concat","toString","ruleInfos","types","rInfo","Core","defaultEnv","FlaggerBase","gatingInfoListeners","_isDict","environment","environmentPromise","handleGatingInfoUpdate","bind","promise","setErrorListener","listener","addGatingInfoListener","removeGatingInfoListener","l","Flagger"],"mappings":"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"}